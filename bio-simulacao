<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulação Bio-Sistêmica</title>
    <style>
        body { margin: 0; background: #050505; color: white; font-family: sans-serif; overflow: hidden; }
        canvas { display: block; }
        .controls { position: absolute; top: 20px; left: 20px; background: rgba(0,0,0,0.7); padding: 15px; border-radius: 8px; border: 1px solid #444; }
        h1 { margin: 0 0 10px 0; font-size: 18px; color: #ff4d4d; }
        .legend { font-size: 12px; line-height: 1.6; }
        .red { color: #ff4d4d; } /* Sangue */
        .blue { color: #4d94ff; } /* Nervos */
    </style>
</head>
<body>

<div class="controls">
    <h1>Simulação Humana</h1>
    <div class="legend">
        <p><b class="red">●</b> Fluxo Sanguíneo (Artéria/Veia)</p>
        <p><b class="blue">⚡</b> Transmissão Nervosa</p>
    </div>
</div>

<canvas id="simCanvas"></canvas>

<script>
const canvas = document.getElementById('simCanvas');
const ctx = canvas.getContext('2d');

let width, height;
let particles = [];
let nerves = [];

// Pontos anatômicos base (proporção corpo masculino)
const bodyPoints = {
    head: { x: 0.5, y: 0.1 },
    heart: { x: 0.5, y: 0.25 },
    handL: { x: 0.2, y: 0.45 },
    handR: { x: 0.8, y: 0.45 },
    footL: { x: 0.4, y: 0.9 },
    footR: { x: 0.6, y: 0.9 }
};

function init() {
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
    particles = [];
    nerves = [];

    // Criar pontos de destino para o sangue
    for (let i = 0; i < 150; i++) {
        particles.push(new BloodParticle());
    }
}

class BloodParticle {
    constructor() {
        this.reset();
    }

    reset() {
        this.x = width * bodyPoints.heart.x;
        this.y = height * bodyPoints.heart.y;
        this.target = this.getRandomExtremity();
        this.speed = Math.random() * 2 + 1;
        this.returning = false;
        this.size = Math.random() * 2 + 1;
    }

    getRandomExtremity() {
        const pts = [bodyPoints.head, bodyPoints.handL, bodyPoints.handR, bodyPoints.footL, bodyPoints.footR];
        return pts[Math.floor(Math.random() * pts.length)];
    }

    update() {
        const tx = this.returning ? width * bodyPoints.heart.x : width * this.target.x;
        const ty = this.returning ? height * bodyPoints.heart.y : height * this.target.y;

        const dx = tx - this.x;
        const dy = ty - this.y;
        const dist = Math.sqrt(dx * dx + dy * dy);

        if (dist < 5) {
            if (!this.returning) this.returning = true;
            else this.reset();
        }

        this.x += (dx / dist) * this.speed;
        this.y += (dy / dist) * this.speed;
    }

    draw() {
        ctx.fillStyle = this.returning ? '#800000' : '#ff0000';
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
    }
}

class NerveImpulse {
    constructor() {
        this.active = Math.random() > 0.95;
        this.path = [bodyPoints.head, bodyPoints.heart, this.getRandomExtremity()];
        this.progress = 0;
    }

    getRandomExtremity() {
        const pts = [bodyPoints.handL, bodyPoints.handR, bodyPoints.footL, bodyPoints.footR];
        return pts[Math.floor(Math.random() * pts.length)];
    }

    draw() {
        if (!this.active) {
            if (Math.random() > 0.99) this.active = true;
            return;
        }

        ctx.strokeStyle = '#4d94ff';
        ctx.lineWidth = 0.5;
        ctx.beginPath();
        ctx.moveTo(width * this.path[0].x, height * this.path[0].y);
        
        for(let i=1; i < this.path.length; i++) {
            ctx.lineTo(width * this.path[i].x, height * this.path[i].y);
        }
        ctx.stroke();

        // Brilho do impulso
        this.progress += 0.02;
        if (this.progress > 1) {
            this.progress = 0;
            this.active = false;
        }
    }
}

// Inicializar nervos
for(let i=0; i<10; i++) nerves.push(new NerveImpulse());

function animate() {
    ctx.fillStyle = 'rgba(5, 5, 5, 0.2)'; // Efeito de rastro
    ctx.fillRect(0, 0, width, height);

    particles.forEach(p => {
        p.update();
        p.draw();
    });

    nerves.forEach(n => n.draw());

    requestAnimationFrame(animate);
}

window.addEventListener('resize', init);
init();
animate();
</script>
</body>
</html>
